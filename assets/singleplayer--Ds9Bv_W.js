import{g as C,e as I,A as _e,B as De,C as Ie,p as x,c as s,j as A,T as U,D as xe,b as P,m as R,E as ae,G as te,I as E,F as _,H as T,a as Pe,d as Ve,J as Se,K as Ae,f as Te,r as Be,L as Ee,M as Oe,N as J,O as Me,P as Le,_ as j,k as B,l as b,w as g,q as V,n as D,v as O,z as He,Q as je,s as W,y as Ge}from"./index-BhuPzLPA.js";import{j as q,k as qe,n as Re,l as We,m as $e,q as Q,t as ne,v as re,w as se,x as le,y as Ne,z as ie,A as N,B as M,C as oe,D as ze,E as de,F as z,G as ce,R as Fe,H as Ke,I as Ue,J as Je,K as Qe,L as Xe,M as Ye,N as Ze,O as ea,P as aa,Q as ta,S as na,f as ra,V as k,a as w,b as L,c as sa}from"./VTextField-CJ_SLb82.js";import{V as H,o as la,c as ia,a as oa,b as da,d as ca,e as ua,f as ma,g as fa,h as ga,i as ya,j as ha,k as va,l as pa,m as ba,n as ka,_ as wa}from"./card_wild_w-CZde25uw.js";import{u as Ca,m as _a,V as X}from"./VOverlay-CwOWQ_wd.js";function Da(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"div",a=arguments.length>2?arguments[2]:void 0;return C()({name:a??_e(Ie(e.replace(/__/g,"-"))),props:{tag:{type:String,default:t},...I()},setup(n,r){let{slots:i}=r;return()=>{var l;return De(n.tag,{class:[e,n.class],style:n.style},(l=i.default)==null?void 0:l.call(i))}}})}const Ia=x({target:[Object,Array]},"v-dialog-transition"),$=new WeakMap,xa=C()({name:"VDialogTransition",props:Ia(),setup(e,t){let{slots:a}=t;const n={onBeforeEnter(r){r.style.pointerEvents="none",r.style.visibility="hidden"},async onEnter(r,i){var h;await new Promise(y=>requestAnimationFrame(y)),await new Promise(y=>requestAnimationFrame(y)),r.style.visibility="";const l=Z(e.target,r),{x:d,y:o,sx:u,sy:c,speed:m}=l;$.set(r,l);const f=q(r,[{transform:`translate(${d}px, ${o}px) scale(${u}, ${c})`,opacity:0},{}],{duration:225*m,easing:$e});(h=Y(r))==null||h.forEach(y=>{q(y,[{opacity:0},{opacity:0,offset:.33},{}],{duration:225*2*m,easing:Q})}),f.finished.then(()=>i())},onAfterEnter(r){r.style.removeProperty("pointer-events")},onBeforeLeave(r){r.style.pointerEvents="none"},async onLeave(r,i){var h;await new Promise(y=>requestAnimationFrame(y));let l;!Array.isArray(e.target)&&!e.target.offsetParent&&$.has(r)?l=$.get(r):l=Z(e.target,r);const{x:d,y:o,sx:u,sy:c,speed:m}=l;q(r,[{},{transform:`translate(${d}px, ${o}px) scale(${u}, ${c})`,opacity:0}],{duration:125*m,easing:We}).finished.then(()=>i()),(h=Y(r))==null||h.forEach(y=>{q(y,[{},{opacity:0,offset:.2},{opacity:0}],{duration:125*2*m,easing:Q})})},onAfterLeave(r){r.style.removeProperty("pointer-events")}};return()=>e.target?s(U,A({name:"dialog-transition"},n,{css:!1}),a):s(U,{name:"dialog-transition"},a)}});function Y(e){var a;const t=(a=e.querySelector(":scope > .v-card, :scope > .v-sheet, :scope > .v-list"))==null?void 0:a.children;return t&&[...t]}function Z(e,t){const a=qe(e),n=Re(t),[r,i]=getComputedStyle(t).transformOrigin.split(" ").map(S=>parseFloat(S)),[l,d]=getComputedStyle(t).getPropertyValue("--v-overlay-anchor-origin").split(" ");let o=a.left+a.width/2;l==="left"||d==="left"?o-=a.width/2:(l==="right"||d==="right")&&(o+=a.width/2);let u=a.top+a.height/2;l==="top"||d==="top"?u-=a.height/2:(l==="bottom"||d==="bottom")&&(u+=a.height/2);const c=a.width/n.width,m=a.height/n.height,f=Math.max(1,c,m),h=c/f||0,y=m/f||0,v=n.width*n.height/(window.innerWidth*window.innerHeight),p=v>.12?Math.min(1.5,(v-.12)*10+1):1;return{x:o-(r+n.left),y:u-(i+n.top),sx:h,sy:y,speed:p}}const ue=C()({name:"VCardActions",props:I(),setup(e,t){let{slots:a}=t;return xe({VBtn:{slim:!0,variant:"text"}}),P(()=>{var n;return s("div",{class:["v-card-actions",e.class],style:e.style},[(n=a.default)==null?void 0:n.call(a)])}),{}}}),Pa=x({opacity:[Number,String],...I(),...R()},"VCardSubtitle"),Va=C()({name:"VCardSubtitle",props:Pa(),setup(e,t){let{slots:a}=t;return P(()=>s(e.tag,{class:["v-card-subtitle",e.class],style:[{"--v-card-subtitle-opacity":e.opacity},e.style]},a)),{}}}),me=Da("v-card-title"),Sa=x({start:Boolean,end:Boolean,icon:E,image:String,text:String,...ce(),...I(),...z(),...de(),...ze(),...R(),...te(),...oe({variant:"flat"})},"VAvatar"),ee=C()({name:"VAvatar",props:Sa(),setup(e,t){let{slots:a}=t;const{themeClasses:n}=ae(e),{borderClasses:r}=ne(e),{colorClasses:i,colorStyles:l,variantClasses:d}=re(e),{densityClasses:o}=se(e),{roundedClasses:u}=le(e),{sizeClasses:c,sizeStyles:m}=Ne(e);return P(()=>s(e.tag,{class:["v-avatar",{"v-avatar--start":e.start,"v-avatar--end":e.end},n.value,r.value,i.value,o.value,u.value,c.value,d.value,e.class],style:[l.value,m.value,e.style]},{default:()=>[a.default?s(M,{key:"content-defaults",defaults:{VImg:{cover:!0,src:e.image},VIcon:{icon:e.icon}}},{default:()=>[a.default()]}):e.image?s(H,{key:"image",src:e.image,alt:"",cover:!0},null):e.icon?s(N,{key:"icon",icon:e.icon},null):e.text,ie(!1,"v-avatar")]})),{}}}),Aa=x({appendAvatar:String,appendIcon:E,prependAvatar:String,prependIcon:E,subtitle:{type:[String,Number,Boolean],default:void 0},title:{type:[String,Number,Boolean],default:void 0},...I(),...z()},"VCardItem"),Ta=C()({name:"VCardItem",props:Aa(),setup(e,t){let{slots:a}=t;return P(()=>{var u;const n=!!(e.prependAvatar||e.prependIcon),r=!!(n||a.prepend),i=!!(e.appendAvatar||e.appendIcon),l=!!(i||a.append),d=!!(e.title!=null||a.title),o=!!(e.subtitle!=null||a.subtitle);return s("div",{class:["v-card-item",e.class],style:e.style},[r&&s("div",{key:"prepend",class:"v-card-item__prepend"},[a.prepend?s(M,{key:"prepend-defaults",disabled:!n,defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon}}},a.prepend):s(_,null,[e.prependAvatar&&s(ee,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&s(N,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)])]),s("div",{class:"v-card-item__content"},[d&&s(me,{key:"title"},{default:()=>{var c;return[((c=a.title)==null?void 0:c.call(a))??T(e.title)]}}),o&&s(Va,{key:"subtitle"},{default:()=>{var c;return[((c=a.subtitle)==null?void 0:c.call(a))??T(e.subtitle)]}}),(u=a.default)==null?void 0:u.call(a)]),l&&s("div",{key:"append",class:"v-card-item__append"},[a.append?s(M,{key:"append-defaults",disabled:!i,defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon}}},a.append):s(_,null,[e.appendIcon&&s(N,{key:"append-icon",density:e.density,icon:e.appendIcon},null),e.appendAvatar&&s(ee,{key:"append-avatar",density:e.density,image:e.appendAvatar},null)])])])}),{}}}),Ba=x({opacity:[Number,String],...I(),...R()},"VCardText"),fe=C()({name:"VCardText",props:Ba(),setup(e,t){let{slots:a}=t;return P(()=>s(e.tag,{class:["v-card-text",e.class],style:[{"--v-card-text-opacity":e.opacity},e.style]},a)),{}}}),Ea=x({appendAvatar:String,appendIcon:E,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:E,ripple:{type:[Boolean,Object],default:!0},subtitle:{type:[String,Number,Boolean],default:void 0},text:{type:[String,Number,Boolean],default:void 0},title:{type:[String,Number,Boolean],default:void 0},...ce(),...I(),...z(),...Ve(),...ta(),...aa(),...ea(),...Ze(),...de(),...Ye(),...R(),...te(),...oe({variant:"elevated"})},"VCard"),Oa=C()({name:"VCard",directives:{Ripple:Fe},props:Ea(),setup(e,t){let{attrs:a,slots:n}=t;const{themeClasses:r}=ae(e),{borderClasses:i}=ne(e),{colorClasses:l,colorStyles:d,variantClasses:o}=re(e),{densityClasses:u}=se(e),{dimensionStyles:c}=Pe(e),{elevationClasses:m}=Ke(e),{loaderClasses:f}=Ue(e),{locationStyles:h}=Je(e),{positionClasses:y}=Qe(e),{roundedClasses:v}=le(e),p=Xe(e,a);return P(()=>{const S=e.link!==!1&&p.isLink.value,G=!e.disabled&&e.link!==!1&&(e.link||p.isClickable.value),ge=S?"a":e.tag,ye=!!(n.title||e.title!=null),he=!!(n.subtitle||e.subtitle!=null),ve=ye||he,pe=!!(n.append||e.appendAvatar||e.appendIcon),be=!!(n.prepend||e.prependAvatar||e.prependIcon),ke=!!(n.image||e.image),we=ve||be||pe,Ce=!!(n.text||e.text!=null);return Se(s(ge,A({class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":G},r.value,i.value,l.value,u.value,m.value,f.value,y.value,v.value,o.value,e.class],style:[d.value,c.value,h.value,e.style],onClick:G&&p.navigate,tabindex:e.disabled?-1:void 0},p.linkProps),{default:()=>{var F;return[ke&&s("div",{key:"image",class:"v-card__image"},[n.image?s(M,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},n.image):s(H,{key:"image-img",cover:!0,src:e.image},null)]),s(na,{name:"v-card",active:!!e.loading,color:typeof e.loading=="boolean"?void 0:e.loading},{default:n.loader}),we&&s(Ta,{key:"item",prependAvatar:e.prependAvatar,prependIcon:e.prependIcon,title:e.title,subtitle:e.subtitle,appendAvatar:e.appendAvatar,appendIcon:e.appendIcon},{default:n.item,prepend:n.prepend,title:n.title,subtitle:n.subtitle,append:n.append}),Ce&&s(fe,{key:"text"},{default:()=>{var K;return[((K=n.text)==null?void 0:K.call(n))??e.text]}}),(F=n.default)==null?void 0:F.call(n),n.actions&&s(ue,null,{default:n.actions}),ie(G,"v-card")]}}),[[Ae("ripple"),G&&e.ripple]])}),{}}}),Ma=x({fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,..._a({origin:"center center",scrollStrategy:"block",transition:{component:xa},zIndex:2400})},"VDialog"),La=C()({name:"VDialog",props:Ma(),emits:{"update:modelValue":e=>!0,afterEnter:()=>!0,afterLeave:()=>!0},setup(e,t){let{emit:a,slots:n}=t;const r=Te(e,"modelValue"),{scopeId:i}=Ca(),l=Be();function d(c){var h,y;const m=c.relatedTarget,f=c.target;if(m!==f&&((h=l.value)!=null&&h.contentEl)&&((y=l.value)!=null&&y.globalTop)&&![document,l.value.contentEl].includes(f)&&!l.value.contentEl.contains(f)){const v=Le(l.value.contentEl);if(!v.length)return;const p=v[0],S=v[v.length-1];m===p?S.focus():p.focus()}}Ee(()=>{document.removeEventListener("focusin",d)}),Oe&&J(()=>r.value&&e.retainFocus,c=>{c?document.addEventListener("focusin",d):document.removeEventListener("focusin",d)},{immediate:!0});function o(){var c;a("afterEnter"),(c=l.value)!=null&&c.contentEl&&!l.value.contentEl.contains(document.activeElement)&&l.value.contentEl.focus({preventScroll:!0})}function u(){a("afterLeave")}return J(r,async c=>{var m;c||(await Me(),(m=l.value.activatorEl)==null||m.focus({preventScroll:!0}))}),P(()=>{const c=X.filterProps(e),m=A({"aria-haspopup":"dialog"},e.activatorProps),f=A({tabindex:-1},e.contentProps);return s(X,A({ref:l,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen,"v-dialog--scrollable":e.scrollable},e.class],style:e.style},c,{modelValue:r.value,"onUpdate:modelValue":h=>r.value=h,"aria-modal":"true",activatorProps:m,contentProps:f,height:e.fullscreen?void 0:e.height,width:e.fullscreen?void 0:e.width,maxHeight:e.fullscreen?void 0:e.maxHeight,maxWidth:e.fullscreen?void 0:e.maxWidth,role:"dialog",onAfterEnter:o,onAfterLeave:u},i),{activator:n.activator,default:function(){for(var h=arguments.length,y=new Array(h),v=0;v<h;v++)y[v]=arguments[v];return s(M,{root:"VDialog"},{default:()=>{var p;return[(p=n.default)==null?void 0:p.call(n,...y)]}})}})}),ra({},l)}}),Ha={name:"GameOverConfirmation",props:{gameWinner:{type:String,default:null},player1:{type:Object,required:!0},player2:{type:Object,required:!0}},computed:{isGameOver(){return this.gameWinner!==null},winnerString(){switch(this.gameWinner){case"white":return"White Wins!";case"black":return"Black Wins!";case"draw":return"It's a Draw!";default:return""}}},methods:{leaveGame(){this.$emit("close")}}};function ja(e,t,a,n,r,i){return b(),B(La,{modelValue:i.isGameOver,"onUpdate:modelValue":t[0]||(t[0]=l=>i.isGameOver=l),"max-width":"400"},{default:g(()=>[s(Oa,{class:"game-over-card"},{default:g(()=>[s(me,{class:"text-h5 font-weight-bold text-center"},{default:g(()=>[V(T(i.winnerString),1)]),_:1}),s(fe,{class:"text-center"},{default:g(()=>[s(k,null,{default:g(()=>[s(w,{class:"text-center"},{default:g(()=>{var l,d,o;return[s(H,{src:((l=a.player1)==null?void 0:l.avatar)||e.blank_avatar,alt:((d=a.player1)==null?void 0:d.username)||"Player 1",class:"avatar-img"},null,8,["src","alt"]),D("p",null,T(((o=a.player1)==null?void 0:o.username)||"Player 1"),1)]}),_:1}),s(w,{class:"text-center"},{default:g(()=>{var l,d,o;return[s(H,{src:((l=a.player2)==null?void 0:l.avatar)||e.blank_avatar,alt:((d=a.player2)==null?void 0:d.username)||"Player 2",class:"avatar-img"},null,8,["src","alt"]),D("p",null,T(((o=a.player2)==null?void 0:o.username)||"Player 2"),1)]}),_:1})]),_:1})]),_:1}),s(ue,{class:"justify-center"},{default:g(()=>[s(L,{color:"primary",onClick:i.leaveGame},{default:g(()=>t[1]||(t[1]=[V("Close")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const Ga=j(Ha,[["render",ja],["__scopeId","data-v-92c1b118"]]),qa={name:"ChatBox",data(){return{}},methods:{}};function Ra(e,t,a,n,r,i){return b(),O(_,null,[s(k,null,{default:g(()=>[s(w,{class:"d-flex justify-center"},{default:g(()=>t[0]||(t[0]=[D("h2",null,"Chat",-1)])),_:1})]),_:1}),s(k,null,{default:g(()=>[s(w,null,{default:g(()=>[s(sa,{label:"Chat is currently disabled... Stay tuned",outlined:""})]),_:1})]),_:1})],64)}const Wa=j(qa,[["render",Ra]]),$a={name:"GameOptions",emits:["offer-draw","resign"],data(){return{}},props:{offeredDraw:{type:Boolean,required:!0}},methods:{offerDraw(){this.$emit("offer-draw")},resign(){this.$emit("resign")}}};function Na(e,t,a,n,r,i){return b(),O(_,null,[s(k,null,{default:g(()=>[s(w,{class:"d-flex justify-center"},{default:g(()=>t[2]||(t[2]=[D("h2",null,"Options",-1)])),_:1})]),_:1}),s(k,{class:"d-flex justify-center game-options"},{default:g(()=>[s(L,{color:"primary",onClick:t[0]||(t[0]=l=>e.$emit("offer-draw")),disabled:a.offeredDraw},{default:g(()=>t[3]||(t[3]=[V(" Offer Draw ")])),_:1},8,["disabled"]),s(L,{color:"error",onClick:t[1]||(t[1]=l=>e.$emit("resign"))},{default:g(()=>t[4]||(t[4]=[V(" Resign ")])),_:1})]),_:1})],64)}const za=j($a,[["render",Na],["__scopeId","data-v-090e1ad3"]]),Fa={name:"CardManagement",emits:["redrawCard","passTurn"],props:{myCardHand:{type:Array,required:!0},myColor:{type:String,required:!0},cardTypes:{type:Array,required:!0}},data(){return{selectedCardIndex:null}},methods:{selectCard(e){this.selectedCardIndex===e?this.selectedCardIndex=null:this.selectedCardIndex=e},redrawCard(e){this.$emit("redraw-card",e,this.selectedCardIndex),this.selectedCardIndex=null},passTurn(){this.$emit("pass-turn")}}};function Ka(e,t,a,n,r,i){return b(),O(_,null,[s(k,null,{default:g(()=>[s(w,{class:"d-flex justify-center"},{default:g(()=>t[2]||(t[2]=[D("h2",null,"My Hand",-1)])),_:1})]),_:1}),s(k,null,{default:g(()=>[(b(!0),O(_,null,He(a.myCardHand,(l,d)=>(b(),B(w,{cols:"4",key:d},{default:g(()=>[s(H,{src:a.cardTypes.find(o=>o.type===l&&o.color===(a.myColor||"white")).image,onClick:o=>i.selectCard(d),style:je({border:d===this.selectedCardIndex?"2px solid red":"none",borderRadius:"20px"})},null,8,["src","onClick","style"])]),_:2},1024))),128))]),_:1}),s(k,{class:"d-flex justify-center card-actions flex-column"},{default:g(()=>[s(L,{color:"warning",onClick:t[0]||(t[0]=l=>i.redrawCard("player1")),disabled:r.selectedCardIndex===null},{default:g(()=>t[3]||(t[3]=[V(" Redraw Card ")])),_:1},8,["disabled"]),s(L,{color:"error",onClick:t[1]||(t[1]=l=>i.passTurn())},{default:g(()=>t[4]||(t[4]=[V(" Pass Turn ")])),_:1})]),_:1})],64)}const Ua=j(Fa,[["render",Ka],["__scopeId","data-v-cf674441"]]),Ja={name:"GamePage",data(){return{gameId:"",gameData:null,handSize:6,cardTypes:[{type:"p",color:"black",image:ia},{type:"p",color:"white",image:oa},{type:"n",color:"black",image:da},{type:"n",color:"white",image:ca},{type:"b",color:"black",image:ua},{type:"b",color:"white",image:ma},{type:"r",color:"black",image:fa},{type:"r",color:"white",image:ga},{type:"q",color:"black",image:ya},{type:"q",color:"white",image:ha},{type:"k",color:"black",image:va},{type:"k",color:"white",image:pa},{type:"w",color:"black",image:ba},{type:"w",color:"white",image:ka}],cardProbabilities:{p:27,n:17,b:17,r:13,q:10,k:10,w:6},selectedCardIndex:null}},async created(){const e=Ge();this.gameId=e.params.gameId,await this.createGame()},methods:{async createGame(){const e=["white","black"],t=Math.floor(Math.random()*e.length),a=e[t],n=e[(t+1)%e.length],r={userId:localStorage.getItem("userId")||"player1",username:localStorage.getItem("username")||"Player 1",color:a,hand:[],avatar:null},i={userId:"opponent",username:"Opponent",color:n,hand:[],avatar:null};for(let d=0;d<this.handSize;d++)r.hand.push(this.drawCard()),i.hand.push(this.drawCard());const l=new la.Game;this.gameData={player1:r,player2:i,game:l,createdAt:Date.now(),mode:"singleplayer",offeredDraw:!1},this.gameId="gameId",r.color==="black"&&this.makeAIMove()},drawCard(){const e=Object.values(this.cardProbabilities).reduce((r,i)=>r+i,0),t=Math.floor(Math.random()*e);let a=0,n=null;for(const[r,i]of Object.entries(this.cardProbabilities))if(a+=i,t<a){n=r;break}if(!n){console.error("No card type found for random value:",t);return}return n},updatePlayerHand(e,t){if(this.gameData){const a=this.gameData[e];if(a&&a.hand.length<this.handSize){const n=this.drawCard();a.hand.splice(t,0,n)}this.gameData[e]=a}},makeAIMove(){const t=this.gameData.player2.hand,a=this.gameData.game,n=a.moves(),r=[];for(const d in n)for(const o of n[d]){const u=a.board.configuration.pieces[d];if(!u)continue;const c=u.toLowerCase();(t.includes(c)||t.includes("w"))&&r.push({from:d,to:o,piece:u})}if(r.length===0){console.warn("AI has no legal moves it can make with its current hand.");const d=Math.floor(Math.random()*t.length);t.splice(d,1),this.gameData.player2.hand=t,this.updatePlayerHand("player2",d),console.warn("Passing turn to player 1."),this.passTurn();return}const i=r[Math.floor(Math.random()*r.length)];a.move(i.from,i.to);let l=t.indexOf(i.piece.toLowerCase());l!==-1?t.splice(l,1):(l=t.indexOf("w"),l!==-1&&t.splice(l,1)),this.updatePlayerHand("player2",l),this.gameData.player2.hand=t,this.gameData.currentTurn="player1",this.gameData.game=a},getLegalMoves(e,t,a,n){const r=[],i=(o,u)=>n[o][u].color!==e.color&&n[o][u].type!=="blank",l=(o,u)=>n[o][u].type==="blank",d=(o,u)=>o>=0&&o<=7&&u>=0&&u<=7;if(e.type==="pawn"){const o=e.color==="white"?1:-1;d(t+o,a)&&l(t+o,a)&&r.push({row:t+o,col:a}),d(t+o,a-1)&&i(t+o,a-1)&&r.push({row:t+o,col:a-1}),d(t+o,a+1)&&i(t+o,a+1)&&r.push({row:t+o,col:a+1})}if(e.type==="king"){const o=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];for(const[u,c]of o){const m=t+u,f=a+c;d(m,f)&&(l(m,f)||i(m,f))&&r.push({row:m,col:f})}}if(e.type==="knight"){const o=[[-2,-1],[-1,-2],[1,-2],[2,-1],[2,1],[1,2],[-1,2],[-2,1]];for(const[u,c]of o){const m=t+u,f=a+c;d(m,f)&&(l(m,f)||i(m,f))&&r.push({row:m,col:f})}}if(e.type==="bishop"||e.type==="rook"||e.type==="queen"){const o=e.type==="bishop"?[[-1,-1],[-1,1],[1,-1],[1,1]]:e.type==="rook"?[[-1,0],[0,-1],[0,1],[1,0]]:[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];for(const[u,c]of o){let m=t+u,f=a+c;for(;d(m,f);){if(l(m,f))r.push({row:m,col:f});else if(i(m,f)){r.push({row:m,col:f});break}else break;m+=u,f+=c}}}return r},endPlayerTurn(e){this.gameData.game=e.game,this.gameData.player1=e.player1,this.gameData.player2=e.player2,this.updatePlayerHand("player1",e.cardIndex),this.victoryState(),!this.gameData.winner&&(this.makeAIMove(),this.victoryState())},passTurn(){this.gameData.game.board.configuration.turn=this.gameData.game.board.configuration.turn==="white"?"black":"white",this.gameData.game.board.configuration.turn!==this.myColor&&(this.makeAIMove(),this.victoryState())},redrawCard(e,t){const a=this.gameData[e].hand;a.splice(t,1),this.gameData[e].hand=a,this.updatePlayerHand(e,t),this.passTurn(),this.selectedCardIndex=null},selectCard(e){this.selectedCardIndex===e?this.selectedCardIndex=null:this.selectedCardIndex=e},offerDraw(){this.gameData.offeredDraw=!0,console.log("Draw offered.")},appectDraw(){this.gameData.winner="draw",console.log("Draw accepted.")},resign(){console.log("Player resigned."),this.gameData.winner=this.gameData.game.board.configuration.turn==="white"?"black":"white"},leaveGame(){this.$router.push("/")},victoryState(){this.hasBlackKing?this.hasWhiteKing?this.isDraw?this.gameData.winner="draw":this.gameData.winner=null:this.gameData.winner="black":this.gameData.winner="white"}},computed:{player1Hand(){return this.gameData?this.gameData.player1.hand:[]},player2Hand(){return this.gameData?this.gameData.player2.hand:[]},myPlayer(){const e=localStorage.getItem("userId");return e===this.gameData.player1.userId?this.gameData.player1:e===this.gameData.player2.userId?this.gameData.player2:null},myCardHand(){return this.myPlayer?this.myPlayer.hand:null},myColor(){return this.myPlayer?this.myPlayer.color:null},hasBlackKing(){return this.gameData&&Object.values(this.gameData.game.board.configuration.pieces).includes("k")},hasWhiteKing(){return this.gameData&&Object.values(this.gameData.game.board.configuration.pieces).includes("K")},onlyKingsLeft(){if(this.gameData){const e=this.gameData.game.board.configuration.pieces;return Object.values(e).filter(t=>t!=="k"&&t!=="K").length===0}return!1},isDraw(){return!!(this.gameData&&(this.onlyKingsLeft||this.gameData.game.board.configuration.halfmove>=50||this.gameData.drawAccepted))},gameWinner(){return this.gameData&&this.gameData.winner?this.gameData.winner:null}}};function Qa(e,t,a,n,r,i){const l=Ua,d=wa,o=za,u=Wa,c=Ga;return b(),O(_,null,[s(k,null,{default:g(()=>[r.gameData?(b(),B(w,{key:0,cols:"3",class:"card-mangement"},{default:g(()=>[s(l,{myCardHand:i.myCardHand,myColor:i.myColor,cardTypes:r.cardTypes,onRedrawCard:i.redrawCard,onPassTurn:i.passTurn},null,8,["myCardHand","myColor","cardTypes","onRedrawCard","onPassTurn"])]),_:1})):W("",!0),s(w,{class:"game-board"},{default:g(()=>[s(k,{class:"chess-board-container"},{default:g(()=>[s(d,{gameData:r.gameData,gameId:r.gameId,onGameUpdated:i.endPlayerTurn},null,8,["gameData","gameId","onGameUpdated"])]),_:1})]),_:1}),r.gameData?(b(),B(w,{key:1,cols:"3",class:"game-mangement"},{default:g(()=>[s(o,{offeredDraw:this.gameData.offeredDraw,onOfferDraw:i.offerDraw,onResign:i.resign},null,8,["offeredDraw","onOfferDraw","onResign"]),t[0]||(t[0]=D("br",null,null,-1)),t[1]||(t[1]=D("br",null,null,-1)),s(u)]),_:1})):W("",!0)]),_:1}),i.gameWinner?(b(),B(c,{key:0,gameWinner:i.gameWinner,player1:this.gameData.player1,player2:this.gameData.player2,onClose:i.leaveGame},null,8,["gameWinner","player1","player2","onClose"])):W("",!0)],64)}const at=j(Ja,[["render",Qa],["__scopeId","data-v-13928a0f"]]);export{at as default};
