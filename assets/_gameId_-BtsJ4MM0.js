import{_ as V,c as G,a as H,b as P,d as T,e as R,f as j,g as q,h as v,i as z,j as N,k as E,l as A,m as M,n as $,V as F}from"./card_wild_w-3Flnz5kw.js";import{r as f,q as k,t as L,v as _,A as D,C,k as d,V as i,l as b,o as J}from"./VTextField-Cb1y2RM5.js";import{_ as K,$ as h,a7 as Q,a0 as g,a1 as l,a4 as I,c as r,a2 as o,a5 as U,V as W,a8 as X,a3 as u}from"./index-Bhd6YrUw.js";const Y={name:"GamePage",components:{ChessBoard:V},data(){return{gameId:"",gameData:null,handSize:5,cardTypes:[{type:"pawn",color:"black",image:G},{type:"pawn",color:"white",image:H},{type:"knight",color:"black",image:P},{type:"knight",color:"white",image:T},{type:"bishop",color:"black",image:R},{type:"bishop",color:"white",image:j},{type:"rook",color:"black",image:q},{type:"rook",color:"white",image:v},{type:"queen",color:"black",image:z},{type:"queen",color:"white",image:N},{type:"king",color:"black",image:E},{type:"king",color:"white",image:A},{type:"wild",color:"black",image:M},{type:"wild",color:"white",image:$}]}},async created(){const e=Q();this.gameId=e.params.gameId,await this.checkOrCreateGame(),this.listenToGame()},methods:{async checkOrCreateGame(){const e=f(k),t=(await _(D(e,`games/${this.gameId}`))).val();if(t.board){this.gameData=t,console.log("Game already exists, loading existing game...");return}console.log("Game does not exist, creating a new one...");const n=(await _(D(e,`games/${this.gameId}/player1`))).val()||null,p=(await _(D(e,`games/${this.gameId}/player2`))).val()||null;let c="player1";n&&n.color&&(c=n.color==="white"?"player1":"player2");const y=this.generateStartingBoard(),m=this.generateStartingDeck(),S=[],x=[];for(let O=0;O<this.handSize;O++)S.push(m.pop()),x.push(m.pop());n.hand=S,p.hand=x;const B=f(k,`games/${this.gameId}`);await C(B,{deck:m,board:y,currentTurn:c,turnNumber:0,player1:n,player2:p,mode:"multiplayer"}),this.gameData={player1:n,player2:p,currentTurn:c,board:y,deck:m,turnNumber:0,mode:"multiplayer"},this.gameId=this.gameId,console.log("Game created successfully with white to start.")},listenToGame(){const e=f(k,`games/${this.gameId}`);L(e,a=>{if(a.exists()){if(this.gameData=a.val(),this.gameData.deck&&this.gameData.deck.length<1){this.gameData.deck=this.generateStartingDeck();const s=f(k,`games/${this.gameId}`);C(s,{deck:this.gameData.deck})}const t={};if(this.gameData.player1.hand.length<this.handSize){const s=this.gameData.deck.splice(-1*(this.handSize-this.gameData.player1.hand.length));this.gameData.player1.hand.push(...s),t["player1/hand"]=this.gameData.player1.hand}if(this.gameData.player2.hand.length<this.handSize){const s=this.gameData.deck.splice(-1*(this.handSize-this.gameData.player2.hand.length));this.gameData.player2.hand.push(...s),t["player2/hand"]=this.gameData.player2.hand}Object.keys(t).length>0&&(t.deck=this.gameData.deck,C(e,t))}else console.error("Game does not exist.")})},generateStartingBoard(){const e=Array.from({length:8},()=>Array.from({length:8},()=>({color:"blank",type:"blank"}))),a=[{type:"rook",col:0},{type:"knight",col:1},{type:"bishop",col:2},{type:"queen",col:3},{type:"king",col:4},{type:"bishop",col:5},{type:"knight",col:6},{type:"rook",col:7}];return a.forEach(t=>{e[0][t.col]={color:"white",type:t.type},e[1][t.col]={color:"white",type:"pawn"}}),a.forEach(t=>{e[7][t.col]={color:"black",type:t.type},e[6][t.col]={color:"black",type:"pawn"}}),e},generateStartingDeck(){const e=[];[{type:"pawn",numberOfCards:16},{type:"knight",numberOfCards:10},{type:"bishop",numberOfCards:10},{type:"rook",numberOfCards:8},{type:"queen",numberOfCards:6},{type:"king",numberOfCards:6},{type:"wild",numberOfCards:4}].forEach(t=>{for(let s=0;s<t.numberOfCards;s++)e.push(t.type)});for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}return e}},computed:{player1Hand(){return this.gameData?this.gameData.player1.hand:[]},player2Hand(){return this.gameData?this.gameData.player2.hand:[]},myPlayer(){const e=localStorage.getItem("userId");return e===this.gameData.player1.userId?this.gameData.player1:e===this.gameData.player2.userId?this.gameData.player2:null},myCardHand(){return this.myPlayer?this.myPlayer.hand:null},myColor(){return this.myPlayer?this.myPlayer.color:null}}};function Z(e,a,t,s,n,w){const p=V;return g(),h(i,null,{default:l(()=>[n.gameData?(g(),h(d,{key:0,cols:"3"},{default:l(()=>[a[1]||(a[1]=o("br",null,null,-1)),r(i,null,{default:l(()=>[r(d,{class:"d-flex justify-center"},{default:l(()=>a[0]||(a[0]=[o("h2",null,"My Hand",-1)])),_:1})]),_:1}),r(i,null,{default:l(()=>[r(d,null,{default:l(()=>[(g(!0),U(W,null,X(w.myCardHand,(c,y)=>(g(),h(i,{key:y},{default:l(()=>[r(F,{src:n.cardTypes.find(m=>m.type===c&&m.color===(w.myColor||"white")).image,height:"100",width:"100"},null,8,["src"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):I("",!0),r(d,{class:"game-board"},{default:l(()=>[r(i,{class:"chess-board-container"},{default:l(()=>[n.gameData?(g(),h(p,{key:0,gameData:n.gameData,gameId:n.gameId},null,8,["gameData","gameId"])):I("",!0)]),_:1})]),_:1}),n.gameData?(g(),h(d,{key:1,cols:"3",class:"game-mangement"},{default:l(()=>[a[10]||(a[10]=o("br",null,null,-1)),r(i,null,{default:l(()=>[r(d,{class:"d-flex justify-center"},{default:l(()=>a[2]||(a[2]=[o("h2",null,"Options",-1)])),_:1})]),_:1}),r(i,null,{default:l(()=>[r(d,{class:"d-flex justify-center"},{default:l(()=>a[3]||(a[3]=[o("h4",null,"(Placeholders for now)",-1)])),_:1})]),_:1}),r(i,{class:"d-flex justify-center"},{default:l(()=>[r(b,null,{default:l(()=>a[4]||(a[4]=[u(" Offer Draw ")])),_:1}),r(b,null,{default:l(()=>a[5]||(a[5]=[u(" Resign ")])),_:1}),r(b,null,{default:l(()=>a[6]||(a[6]=[u(" Surrender ")])),_:1})]),_:1}),a[11]||(a[11]=o("br",null,null,-1)),a[12]||(a[12]=o("br",null,null,-1)),r(i,null,{default:l(()=>[a[8]||(a[8]=u(" Chat messages will be displayed here. ")),r(d,{cols:"12"},{default:l(()=>[r(J,{label:"Chat is currently disabled... Stay tuned",outlined:""}),r(b,{color:"primary",disabled:!0},{default:l(()=>a[7]||(a[7]=[u("Send")])),_:1})]),_:1})]),_:1}),r(i,null,{default:l(()=>[r(d,{cols:"12"},{default:l(()=>a[9]||(a[9]=[o("p",null,[o("strong",null,"Player 1:"),u(" Hello!")],-1),o("p",null,[o("strong",null,"Player 2:"),u(" Hi there!")],-1)])),_:1})]),_:1})]),_:1})):I("",!0)]),_:1})}const la=K(Y,[["render",Z],["__scopeId","data-v-d70ab8e4"]]);export{la as default};
