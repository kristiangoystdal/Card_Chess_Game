import{_ as V,c as G,a as H,b as P,d as T,e as R,f as j,g as q,h as z,i as v,j as N,k as E,l as F,m as M,n as A,V as $}from"./card_wild_w-CZde25uw.js";import{r as f,d as k,o as L,g as _,i as D,u as C,a as d,V as i,b,c as J}from"./VTextField-CJ_SLb82.js";import{_ as K,k as h,y as Q,l as g,w as l,s as I,c as r,n as o,v as U,F as W,z as X,q as u}from"./index-BhuPzLPA.js";const Y={name:"GamePage",components:{ChessBoard:V},data(){return{gameId:"",gameData:null,handSize:5,cardTypes:[{type:"pawn",color:"black",image:G},{type:"pawn",color:"white",image:H},{type:"knight",color:"black",image:P},{type:"knight",color:"white",image:T},{type:"bishop",color:"black",image:R},{type:"bishop",color:"white",image:j},{type:"rook",color:"black",image:q},{type:"rook",color:"white",image:z},{type:"queen",color:"black",image:v},{type:"queen",color:"white",image:N},{type:"king",color:"black",image:E},{type:"king",color:"white",image:F},{type:"wild",color:"black",image:M},{type:"wild",color:"white",image:A}]}},async created(){const a=Q();this.gameId=a.params.gameId,await this.checkOrCreateGame(),this.listenToGame()},methods:{async checkOrCreateGame(){const a=f(k),t=(await _(D(a,`games/${this.gameId}`))).val();if(t.board){this.gameData=t,console.log("Game already exists, loading existing game...");return}console.log("Game does not exist, creating a new one...");const n=(await _(D(a,`games/${this.gameId}/player1`))).val()||null,c=(await _(D(a,`games/${this.gameId}/player2`))).val()||null;let p="player1";n&&n.color&&(p=n.color==="white"?"player1":"player2");const y=this.generateStartingBoard(),m=this.generateStartingDeck(),S=[],x=[];for(let O=0;O<this.handSize;O++)S.push(m.pop()),x.push(m.pop());n.hand=S,c.hand=x;const B=f(k,`games/${this.gameId}`);await C(B,{deck:m,board:y,currentTurn:p,turnNumber:0,player1:n,player2:c,mode:"multiplayer"}),this.gameData={player1:n,player2:c,currentTurn:p,board:y,deck:m,turnNumber:0,mode:"multiplayer"},this.gameId=this.gameId,console.log("Game created successfully with white to start.")},listenToGame(){const a=f(k,`games/${this.gameId}`);L(a,e=>{if(e.exists()){if(this.gameData=e.val(),this.gameData.deck&&this.gameData.deck.length<1){this.gameData.deck=this.generateStartingDeck();const s=f(k,`games/${this.gameId}`);C(s,{deck:this.gameData.deck})}const t={};if(this.gameData.player1.hand.length<this.handSize){const s=this.gameData.deck.splice(-1*(this.handSize-this.gameData.player1.hand.length));this.gameData.player1.hand.push(...s),t["player1/hand"]=this.gameData.player1.hand}if(this.gameData.player2.hand.length<this.handSize){const s=this.gameData.deck.splice(-1*(this.handSize-this.gameData.player2.hand.length));this.gameData.player2.hand.push(...s),t["player2/hand"]=this.gameData.player2.hand}Object.keys(t).length>0&&(t.deck=this.gameData.deck,C(a,t))}else console.error("Game does not exist.")})},generateStartingBoard(){const a=Array.from({length:8},()=>Array.from({length:8},()=>({color:"blank",type:"blank"}))),e=[{type:"rook",col:0},{type:"knight",col:1},{type:"bishop",col:2},{type:"queen",col:3},{type:"king",col:4},{type:"bishop",col:5},{type:"knight",col:6},{type:"rook",col:7}];return e.forEach(t=>{a[0][t.col]={color:"white",type:t.type},a[1][t.col]={color:"white",type:"pawn"}}),e.forEach(t=>{a[7][t.col]={color:"black",type:t.type},a[6][t.col]={color:"black",type:"pawn"}}),a},generateStartingDeck(){const a=[];[{type:"pawn",numberOfCards:16},{type:"knight",numberOfCards:10},{type:"bishop",numberOfCards:10},{type:"rook",numberOfCards:8},{type:"queen",numberOfCards:6},{type:"king",numberOfCards:6},{type:"wild",numberOfCards:4}].forEach(t=>{for(let s=0;s<t.numberOfCards;s++)a.push(t.type)});for(let t=a.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[a[t],a[s]]=[a[s],a[t]]}return a}},computed:{player1Hand(){return this.gameData?this.gameData.player1.hand:[]},player2Hand(){return this.gameData?this.gameData.player2.hand:[]},myPlayer(){const a=localStorage.getItem("userId");return a===this.gameData.player1.userId?this.gameData.player1:a===this.gameData.player2.userId?this.gameData.player2:null},myCardHand(){return this.myPlayer?this.myPlayer.hand:null},myColor(){return this.myPlayer?this.myPlayer.color:null}}};function Z(a,e,t,s,n,w){const c=V;return g(),h(i,null,{default:l(()=>[n.gameData?(g(),h(d,{key:0,cols:"3"},{default:l(()=>[e[1]||(e[1]=o("br",null,null,-1)),r(i,null,{default:l(()=>[r(d,{class:"d-flex justify-center"},{default:l(()=>e[0]||(e[0]=[o("h2",null,"My Hand",-1)])),_:1})]),_:1}),r(i,null,{default:l(()=>[r(d,null,{default:l(()=>[(g(!0),U(W,null,X(w.myCardHand,(p,y)=>(g(),h(i,{key:y},{default:l(()=>[r($,{src:n.cardTypes.find(m=>m.type===p&&m.color===(w.myColor||"white")).image,height:"100",width:"100"},null,8,["src"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):I("",!0),r(d,{class:"game-board"},{default:l(()=>[r(i,{class:"chess-board-container"},{default:l(()=>[n.gameData?(g(),h(c,{key:0,gameData:n.gameData,gameId:n.gameId},null,8,["gameData","gameId"])):I("",!0)]),_:1})]),_:1}),n.gameData?(g(),h(d,{key:1,cols:"3",class:"game-mangement"},{default:l(()=>[e[10]||(e[10]=o("br",null,null,-1)),r(i,null,{default:l(()=>[r(d,{class:"d-flex justify-center"},{default:l(()=>e[2]||(e[2]=[o("h2",null,"Options",-1)])),_:1})]),_:1}),r(i,null,{default:l(()=>[r(d,{class:"d-flex justify-center"},{default:l(()=>e[3]||(e[3]=[o("h4",null,"(Placeholders for now)",-1)])),_:1})]),_:1}),r(i,{class:"d-flex justify-center"},{default:l(()=>[r(b,null,{default:l(()=>e[4]||(e[4]=[u(" Offer Draw ")])),_:1}),r(b,null,{default:l(()=>e[5]||(e[5]=[u(" Resign ")])),_:1}),r(b,null,{default:l(()=>e[6]||(e[6]=[u(" Surrender ")])),_:1})]),_:1}),e[11]||(e[11]=o("br",null,null,-1)),e[12]||(e[12]=o("br",null,null,-1)),r(i,null,{default:l(()=>[e[8]||(e[8]=u(" Chat messages will be displayed here. ")),r(d,{cols:"12"},{default:l(()=>[r(J,{label:"Chat is currently disabled... Stay tuned",outlined:""}),r(b,{color:"primary",disabled:!0},{default:l(()=>e[7]||(e[7]=[u("Send")])),_:1})]),_:1})]),_:1}),r(i,null,{default:l(()=>[r(d,{cols:"12"},{default:l(()=>e[9]||(e[9]=[o("p",null,[o("strong",null,"Player 1:"),u(" Hello!")],-1),o("p",null,[o("strong",null,"Player 2:"),u(" Hi there!")],-1)])),_:1})]),_:1})]),_:1})):I("",!0)]),_:1})}const le=K(Y,[["render",Z],["__scopeId","data-v-d70ab8e4"]]);export{le as default};
